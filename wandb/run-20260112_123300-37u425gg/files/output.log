[EnvVec] N_per_rank=2 world=4 total_envs=8
[Obs] num_ids(K)=11 vec_dim=103 map_shape=(90, 160)
[Act] continuous=False action_dim=8 action_nvec=[2, 2, 2, 2, 2, 2, 2, 2]
[Rollout] update_timestep=4000 -> horizon=2000 effective_T=4000
[Resume] loading: /root/libimmortal/src/libimmortal/samples/PPO/checkpoints/PPO_ImmortalSufferingEnv_seed42_950000.pth
[Start] 2026-01-12 12:33:11
[ckpt_dir] /root/libimmortal/src/libimmortal/samples/PPO/checkpoints
[FATAL] exception=RuntimeError('[WorkerResetFail] i=0 where=worker_loop err=UnityWorkerInUseException("Couldn\'t start socket communication because worker number 0 is still in use. You may need to manually close a previously opened environment or use a different worker number.")\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 87, in check_port\n    s.bind(("localhost", port))\nOSError: [Errno 98] Address already in use\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/root/libimmortal/src/libimmortal/samples/PPO/train_vec.py", line 280, in _worker_loop\n    env, id_map, vec_obs, K, env_info = _make_env(seed)\n  File "/root/libimmortal/src/libimmortal/samples/PPO/train_vec.py", line 204, in _make_env\n    env = ImmortalSufferingEnv(\n  File "/root/libimmortal/src/libimmortal/env.py", line 29, in __init__\n    self._create_env(game_path, port, time_scale, seed, width, height)\n  File "/root/libimmortal/src/libimmortal/env.py", line 52, in _create_env\n    self._unity_env = UnityEnvironment(\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/environment.py", line 189, in __init__\n    self._communicator = self._get_communicator(worker_id, base_port, timeout_wait)\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/environment.py", line 267, in _get_communicator\n    return RpcCommunicator(worker_id, base_port, timeout_wait)\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 51, in __init__\n    self.create_server()\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 57, in create_server\n    self.check_port(self.port)\n  File "/usr/local/lib/python3.10/site-packages/mlagents_envs/rpc_communicator.py", line 89, in check_port\n    raise UnityWorkerInUseException(self.worker_id)\nmlagents_envs.exception.UnityWorkerInUseException: Couldn\'t start socket communication because worker number 0 is still in use. You may need to manually close a previously opened environment or use a different worker number.\n')
Final model saved at: /root/libimmortal/src/libimmortal/samples/PPO/checkpoints/PPO_ImmortalSufferingEnvVec_seed42_951998.pth